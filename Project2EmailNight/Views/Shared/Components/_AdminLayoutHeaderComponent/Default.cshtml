@using Project2EmailNight.Dtos
@model UserHeaderUIDto
@{
    Layout = null;
}

@if (Model == null)
{
	return;
}

<header class="top-header">
	<nav class="navbar navbar-expand">
	@* 	<div class="left-topbar d-flex align-items-center">
			<a href="javascript:;" class="toggle-btn">
				<i class="bx bx-menu"></i>
			</a>
		</div> *@
		<div class="d-flex align-items-center">
			<a href="/Email/SendEmail" class="d-flex align-items-center text-decoration-none">
				<img src="@Url.Content("~/vertical-20260127T171413Z-3-001/vertical/assets/images/logo-icon.png")"
					 alt="Logo"
					 style="height:40px;" />
			</a>
		</div>
		<div class="right-topbar ms-auto">
			<ul class="navbar-nav">
				<li class="nav-item search-btn-mobile">
					<a class="nav-link position-relative" href="javascript:;">
						<i class="bx bx-search vertical-align-middle"></i>
					</a>
				</li>
				<li class="nav-item dropdown dropdown-lg">
					<a class="nav-link dropdown-toggle dropdown-toggle-nocaret position-relative" href="javascript:;" data-bs-toggle="dropdown">
						<span class="msg-count">@Model.UnreadCount</span>
						<i class="bx bx-comment-detail vertical-align-middle"></i>
					</a>
					<div class="dropdown-menu dropdown-menu-end">
						<a href="javascript:;">
							<div class="msg-header">
								<h6 class="msg-header-title">Yeni Mesajlar</h6>
								@* <p class="msg-header-subtitle"></p> *@
							</div>
						</a>
						<div class="header-message-list">

							@if (Model.UnreadMessages != null && Model.UnreadMessages.Any())
							{
								foreach (var item in Model.UnreadMessages)
								{
									<a class="dropdown-item" href="/Email/MessageDetails/@item.MessageId">
										<div class="d-flex align-items-center">
											<div class="user-online">
												<img src="~/vertical-20260127T171413Z-3-001/vertical/assets/images/avatars/avatar-1.png"
													 class="msg-avatar" alt="user avatar">
											</div>
											<div class="flex-grow-1">
												<h6 class="msg-name">
													@item.SenderEmail
													<span class="msg-time float-end">
														@item.SendDate.ToString("dd MMM HH:mm")
													</span>
												</h6>
												<p class="msg-info">
													@(string.IsNullOrEmpty(item.Subject)
																								? ""
																								: item.Subject.Length > 35
																								? item.Subject.Substring(0, 35) + "..."
																								: item.Subject)
										</p>
									</div>
								</div>
							</a>
														}
							}
							else
							{
								<div class="p-3 text-center text-muted">
									Yeni mesaj yok
								</div>
							}

						</div>

						<a href="/Email/SendEmail">
							<div class="text-center msg-footer">View All Messages</div>
						</a>
					</div>
				</li>
				<li class="nav-item dropdown dropdown-user-profile">
					<a class="nav-link dropdown-toggle dropdown-toggle-nocaret" href="javascript:;" data-bs-toggle="dropdown">
						<div class="d-flex user-box align-items-center">
							<div class="user-info">
								<p class="user-name mb-0">@Model.FullName</p>
								<p class="designattion mb-0">Çevrimiçi</p>
							</div>
							<img src="@Url.Content(Model.ImageUrl)" class="user-img" alt="user avatar">

						</div>
					</a>
					<div class="dropdown-menu dropdown-menu-end">
						<a class="dropdown-item" asp-controller="Profile" asp-action="Index">
							<i class="bx bx-user"></i><span>Profilim</span>
						</a>
						<a class="dropdown-item" asp-controller="Email" asp-action="SendEmail">
							<i class="bx bx-message"></i><span>Mesajlarım </span>
						</a>
						<a class="dropdown-item" href="javascript:;">
							<i class="bx bx-cog"></i><span>Ayarlar</span>
						</a>
						
						<div class="dropdown-divider mb-0"></div>	<form asp-controller="Login" asp-action="Logout" method="post" class="dropdown-item p-0 m-0">
							@Html.AntiForgeryToken()
							<button type="submit" class="btn w-100 text-start">
								<i class="bx bx-power-off"></i> Çıkış Yap
							</button>
						</form>

					</div>
				</li>
			</ul>
		</div>
	</nav>
</header>